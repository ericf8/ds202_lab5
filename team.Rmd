---
title: "team"
author: "Eric Friesth, Aashwin Lamsal"
date: "11/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Processing the data

```{r}
library(tidyverse)
df = read.table('diabetes.txt', header=TRUE)

df[df==""]<-NA #replacing empty strings with NA's

df = droplevels(df) #using droplevels as specified in the spec


removed_cols <- c("id","bp.2s", "bp.2d")
diabetes_reduced <- df %>% select(-removed_cols) #dropping the id, bp.2s, and bp.2d columns
#view(diabetes_reduced)

index.na=apply(is.na(diabetes_reduced), 1, any) # used to identify rows with missing value.

diabetes_clean<- na.omit(diabetes_reduced) #na.omit drops all rows with any NA Values

```
5. The way that we check if step four was done correctly, we used sum and is.na to see the
number of rows with NA values, as seen below.
```{r}
print(sum(is.na(diabetes_clean)))

```

## Exploring and Transforming data

6. You can fix the right skewness of glyhb by setting the x limits of the plot using + xlim(),
the downside of using this is we ignore outliers that lie to the right of the distribution
thus removing 44 rows.

```{r}
library(dplyr)

ggplot(diabetes_clean, aes(x = glyhb)) + geom_histogram() + labs(title = "Distribution of Glycosolated Hemoglobin", x = "Glycosolated Hemoglobin", y = "Frequency") # plotted a histogram of the variable glyhb to see the skewness

ggplot(diabetes_clean, aes(x = glyhb)) + geom_histogram() + xlim(2, 8) + labs(title = "Distribution of Glycosolated Hemoglobin", x = "Glycosolated Hemoglobin", y = "Frequency") # set limits on the x axis to create a better looking distribution without the outliers greater than 8

diabetes_clean$glyhb[diabetes_clean$glyhb > 8] <- NA # applies NA to any glyhb being greater than 8 

diabetes_clean = na.omit(diabetes_clean) # dropped those new 44 rows 

names(diabetes_clean)[names(diabetes_clean) == 'glyhb'] <- 'glyhb_star' # renamed that column to be glyhb_star

ggplot(diabetes_clean, aes(x = glyhb_star)) + geom_histogram() + labs(title = "Distribution of Glycosolated Hemoglobin", x = "Glycosolated Hemoglobin", y = "Frequency")
```

Summary Statistics of glyhb_star

```{r}

summary(diabetes_clean$glyhb_star) #summary of the variable glyhb_star

diabetes_clean %>% group_by(frame)%>% summarise(mean(glyhb_star)) # looking at the mean values of glyhb_star by the frames (small medium and large)

```

## Visualizations

```{r}
library(ggplot2)

diabetes_clean %>% group_by(frame,location) %>% summarise (mean.glyhb_star= mean(glyhb_star)) 

```

# glyhb_star against ratio
```{r}

ggplot(diabetes_clean, aes(glyhb_star, ratio, color = frame)) + geom_point() + labs(x= "Glycosolated Hemoglobin", y="Ratio", title = "Relationship between Glycosolated Hemoglobin and ratio")

```

# glyhb_star against bp.1s
```{r}
ggplot(diabetes_clean, aes(glyhb_star, bp.1s, color = frame)) + geom_point() + labs(x= "Glycosolated Hemoglobin", y="bp.1s", title = "Relationship between Glycosolated Hemoglobin and bp.1s")


```
# glyhb_star against age
```{r}
ggplot(diabetes_clean, aes(glyhb_star, age, color = frame)) + geom_point() + labs(x= "Glycosolated Hemoglobin", y="Age", title = "Relationship between Glycosolated Hemoglobin and age")


```
# glyhb_star against gender
```{r}

ggplot(diabetes_clean, aes(gender, glyhb_star, color = frame)) + geom_boxplot() + labs(x= "Gender", y="Glycosolated Hemoglobin", title = "Relationship between Glycosolated Hemoglobin and gender")

```
# glyhb_star against hip
```{r}
ggplot(diabetes_clean, aes(glyhb_star, hip, color = frame)) + geom_point() + labs(x= "Glycosolated Hemoglobin", y="Hip", title = "Relationship between Glycosolated Hemoglobin and hip")


```
# glyhb_star against weight
```{r}
ggplot(diabetes_clean, aes(glyhb_star, weight, color = frame)) + geom_point() + labs(x= "Glycosolated Hemoglobin", y="Weight", title = "Relationship between Glycosolated Hemoglobin and weight")


```

## Messy Data

13. The function gather() is used to make tables more narrow in width and longer in length
while the function spread() is used to do the opposite with a dataset, make it longer in width
and shorter in length. More specifically, these functions are used to reformat the dataset to
view it in a different way (stacking).

14. These functions are related in that they both reformat your data to make it more readable.
They complement each other on the common Key and Value. 

## Regression Models

```{r}

fit = lm(glyhb_star ~stab.glu + age + waist + ratio+ factor(frame),data=diabetes_clean)

summary(fit)

```










